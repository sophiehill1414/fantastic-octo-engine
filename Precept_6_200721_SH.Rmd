---
title: "Precept 6"
author: "Sophie Hill"
date: "7/21/2020"
output: word_document
---
```{r}
library(readr)
senate <- read.csv("senate.csv")

my_first_function <- function(n){
 k <- n*n 
 return(k)
}
my_first_function(10)

my_second_function <- function(x,y){
  a <- (x-y)^2
  return(a)
} 
my_second_function(3,9)

h <- c(1,2,3)
my_second_function(h,9)


senate <- read.csv("senate.csv", header=TRUE) 

 
z_stat <- function(x1,x0,v1,v0,n1,n0){
 
se <- sqrt((v1/n1) + (v0/n0)) 
 
z <- ((x1-x0)-0)/se
class(z)   

z <- as.numeric(z)
return(z) 
} 
 
 
means1 <- mean(senate[senate$treatment==1, "bill_prop"]) 
means0 <- mean(senate[senate$treatment==0, "bill_prop"]) 
 
 
var1 <- sd(senate[senate$treatment==1, "bill_prop"])^2 
var0 <- sd(senate[senate$treatment==0, "bill_prop"])^2 

n1 <- nrow(senate[senate$treatment==1,])
n0 <- nrow(senate[senate$treatment==0,])
 
2 * pnorm(abs(z_stat(means1,means0,var1,var0,n1,n0)), lower.tail=FALSE)
pnorm(z_stat(means1,means0,var1,var0,n1,n0))
      
hyp_test <- t.test(senate$bill_prop[senate$treatment==1],senate$bill_prop[senate$treatment==0], var.equal=FALSE, alternative="two.sided",conf.level=.95)
hyp_test
 
# Retain the null hypothesis


hyp_test$p.value

hyp_test$statistic

hyp_test$conf.int 

hyp_test$parameter 

hyp_test$estimate

hyp_test$estimate[1]

hyp_test$estimate[2]

lm1 <- summary(lm(bill_prop~treatment, data=senate))
lm1
#The estimate for treatment and difference in means are equal. The P-value for treatment is a little bit bigger than the one we used last week

lm1$coefficients
lm1$coefficients[,1]
lm1$coefficients[,2] 
lm1$coefficients[,3] 
lm1$coefficients[,4] 
lm1$residuals 
lm1$df
lm1$adj.r.squared 

#mean(senate[treatment==1], na.rm=TRUE)
  # We want to observe the mean here.

library(tidyverse)
senate %>%
  group_by(treatment) %>% 
  summarize(mean(bill_prop, na.rm=TRUE))
    # The error with this code was that the tidyverse package was not called and was       unable to perform the function %>%


senate$party_v2 <- ifelse(senate$party==1, "Democrat", "Republican")
#senate$party_v2 + senate$treatment
 

#cor(senate$bill_prop[senate$treatment==1], senate$bill_prop[senate$treatment==0])
  #I dont think this code can be correlated itself. 


```


```

